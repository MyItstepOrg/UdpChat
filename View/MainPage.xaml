<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:view="clr-namespace:UdpChat.View.MainPage"
             xmlns:viewModel="clr-namespace:UdpChat.ViewModel"
             x:Class="UdpChat.View.MainPage"
             x:DataType="viewModel:MainViewModel">

    <Grid
        ColumnDefinitions="*"
        RowDefinitions="55, *, 60"
        RowSpacing="2">
        <Border
            Padding="2"
            StrokeThickness="2"
            StrokeShape="RoundRectangle 3"
            Stroke="Gray">
            <HorizontalStackLayout Spacing="4">
                <Entry MinimumWidthRequest="350" Placeholder="IP" Text="{Binding Ip}" IsEnabled="{Binding IsNotConnected}"/>
                <Entry MinimumWidthRequest="150" Placeholder="Port" Text="{Binding Port}" IsEnabled="{Binding IsNotConnected}"/>
                <Button Text="Connect" Command="{Binding ConnectCommand}" IsEnabled="{Binding IsNotConnected}" CornerRadius="3"/>
                <Button Text="Disconnect" Command="{Binding DisconnectCommand}" IsEnabled="{Binding IsConnected}" CornerRadius="3"/>
            </HorizontalStackLayout>
        </Border>

        <Border
            Grid.Row="1"
            Padding="2"
            StrokeThickness="2"
            StrokeShape="RoundRectangle 3"
            Stroke="Gray">
            <CollectionView ItemsSource="{Binding MessageHistory}">
                <CollectionView.ItemTemplate>
                    <!--TODO: Add x:DataType to collection view-->
                    <DataTemplate>
                        <Border
                            StrokeShape="RoundRectangle 5"
                            BackgroundColor="Gray">
                            <Grid
                                RowDefinitions="*, *"
                                ColumnDefinitions="115, 40,*">
                                <Label Text=""/>
                                <Label Grid.Column="1" Text="|"/>
                                <Label Grid.Column="2" Grid.RowSpan="2" Text=""/>
                                <Label Grid.Row="1" Text=""/>
                                <Label Grid.Column="1" Grid.Row="1" Text="|"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Border>

        <Border
            Grid.Row="2"
            Padding="2"
            StrokeThickness="2"
            StrokeShape="RoundRectangle 3"
            Stroke="Gray">
            <FlexLayout>
                <Entry FlexLayout.Grow="1" Text="{Binding Message}" IsEnabled="{Binding IsConnected}"/>
                <Button WidthRequest="100" Text="Send" Command="{Binding SendCommand}" IsEnabled="{Binding IsConnected}" CornerRadius="3"/>
            </FlexLayout>
        </Border>
    </Grid>

</ContentPage>
